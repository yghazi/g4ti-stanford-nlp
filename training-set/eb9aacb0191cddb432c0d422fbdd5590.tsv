Unit	NN	O
42	CD	O
has	VBZ	O
discovered	VBN	O
a	DT	O
persistent	JJ	O
attack	NN	O
campaign	NN	O
operating	VBG	O
primarily	RB	O
in	IN	O
the	DT	O
Middle	NNP	LOCATION
East	NNP	LOCATION
dating	VBG	O
back	RB	O
to	TO	O
at	IN	O
least	JJS	O
mid-2016	JJ	O
which	WDT	O
we	PRP	O
have	VBP	O
named	VBN	O
Magic	NNP	O
Hound	NNP	O
.	.	O
This	DT	O
appears	VBZ	O
to	TO	O
be	VB	O
an	DT	O
attack	NN	O
campaign	NN	O
focused	VBD	O
on	IN	O
espionage	NN	EFFECT
.	.	O
Based	VBN	O
upon	IN	O
our	PRP$	O
visibility	NN	O
it	PRP	O
has	VBZ	O
primarily	RB	O
targeted	VBN	O
organizations	NNS	O
in	IN	O
the	DT	O
energy	NN	INDUSTRY
,	,	O
government	NN	INDUSTRY
,	,	O
and	CC	O
technology	NN	INDUSTRY
sectors	NNS	INDUSTRY
that	WDT	O
are	VBP	O
either	DT	O
based	VBN	O
or	CC	O
have	VBP	O
business	NN	O
interests	NNS	O
in	IN	O
Saudi	NNP	LOCATION
Arabia	NNP	LOCATION
.	.	O
The	DT	O
adversaries	NNS	O
appear	VBP	O
to	TO	O
have	VB	O
evolved	VBN	O
their	PRP$	O
tactics	NNS	O
and	CC	O
techniques	NNS	O
throughout	IN	O
the	DT	O
tracked	JJ	O
time	NN	O
-	:	O
period	NN	O
,	,	O
iterating	VBG	O
through	IN	O
a	DT	O
diverse	JJ	O
toolset	NN	O
across	IN	O
different	JJ	O
waves	NNS	O
of	IN	O
attacks	NNS	O
.	.	O
Link	NNP	O
analysis	NN	O
of	IN	O
infrastructure	NN	O
and	CC	O
tools	NNS	O
also	RB	O
revealed	VBD	O
a	DT	O
potential	JJ	O
relationship	NN	O
between	IN	O
Magic	NNP	O
Hound	NNP	O
and	CC	O
the	DT	O
adversary	JJ	O
group	NN	O
called	VBD	O
"	NNP	O
Rocket	NNP	ACTOR
Kitten	NNP	ACTOR
"	NNP	O
(	(	O
AKA	NNP	O
Operation	NNP	ACTOR
Saffron	NNP	ACTOR
Rose	NNP	ACTOR
,	,	O
Ajax	NNP	ACTOR
Security	NNP	ACTOR
Team	NNP	ACTOR
,	,	O
Operation	NNP	O
Woolen	NNP	O
-	:	O
Goldfish	NN	O
)	)	O
as	RB	O
well	RB	O
as	IN	O
an	DT	O
older	JJR	O
attack	NN	O
campaign	NN	O
called	VBN	O
Newscasters	NNP	O
.	.	O
Artifacts	NNS	O
of	IN	O
this	DT	O
campaign	NN	O
was	VBD	O
also	RB	O
recently	RB	O
published	VBN	O
by	IN	O
Secureworks	NNP	O
CTU	NNP	O
.	.	O
We	PRP	O
were	VBD	O
able	JJ	O
to	TO	O
collect	VB	O
over	IN	O
fifty	JJ	O
samples	NNS	O
of	IN	O
the	DT	O
tools	NNS	O
used	VBN	O
by	IN	O
the	DT	O
Magic	NNP	O
Hound	NNP	O
campaign	NN	O
using	VBG	O
the	DT	O
AutoFocus	NNP	O
threat	NN	O
intelligence	NN	O
tool	NN	O
.	.	O
The	DT	O
earliest	JJS	O
malware	NN	O
sample	NN	O
we	PRP	O
were	VBD	O
able	JJ	O
to	TO	O
collect	VB	O
had	VBD	O
a	DT	O
compile	NN	O
timestamp	NN	O
in	IN	O
May	NNP	O
2016	CD	O
.	.	O
The	DT	O
samples	NNS	O
themselves	PRP	O
ranged	VBD	O
from	IN	O
IRC	NNP	TOOL
bots	NNS	TOOL
,	,	O
an	DT	O
open	JJ	O
source	NN	O
Python	NNP	O
remote	VBZ	TOOL
access	NN	TOOL
tool	NN	TOOL
,	,	O
malicious	JJ	TOOL
macros	NNS	TOOL
,	,	O
and	CC	O
others	NNS	O
.	.	O
It	PRP	O
is	VBZ	O
believed	VBN	O
the	DT	O
use	NN	O
of	IN	O
specific	JJ	O
tools	NNS	O
may	MD	O
have	VB	O
coincided	VBN	O
with	IN	O
specific	JJ	O
attack	NN	O
waves	NNS	O
by	IN	O
this	DT	O
adversary	NN	O
,	,	O
with	IN	O
the	DT	O
most	RBS	O
recent	JJ	O
attacks	NNS	O
using	VBG	O
weaponized	JJ	TOOL
Microsoft	NNP	TOOL
Office	NNP	TOOL
documents	NNS	TOOL
with	IN	O
malicious	JJ	TOOL
macros	NNS	TOOL
.	.	O
Due	JJ	O
to	TO	O
the	DT	O
large	JJ	O
amount	NN	O
of	IN	O
data	NNS	O
collected	VBN	O
,	,	O
and	CC	O
limitations	NNS	O
on	IN	O
attack	NN	O
telemetry	NN	O
,	,	O
this	DT	O
blog	NN	O
will	MD	O
focus	VB	O
primarily	RB	O
on	IN	O
the	DT	O
most	RBS	O
recent	JJ	O
attacks	NNS	O
occurring	VBG	O
in	IN	O
the	DT	O
latter	JJ	O
half	NN	O
of	IN	O
2016	CD	O
.	.	O
The	DT	O
samples	NNS	O
initially	RB	O
collected	VBD	O
and	CC	O
associated	VBN	O
with	IN	O
Magic	NNP	O
Hound	NNP	O
were	VBD	O
Microsoft	NNP	O
Word	NNP	O
and	CC	O
Excel	NNP	O
documents	NNS	O
containing	VBG	O
embedded	VBD	O
malicious	JJ	TOOL
macros	NNS	TOOL
.	.	O
We	PRP	O
were	VBD	O
able	JJ	O
to	TO	O
expand	VB	O
our	PRP$	O
data	NNS	O
set	VBN	O
by	IN	O
pivoting	VBG	O
on	IN	O
infrastructure	NN	O
and	CC	O
tool	NN	O
behavior	NN	O
,	,	O
which	WDT	O
uncovered	VBD	O
additional	JJ	O
types	NNS	O
of	IN	O
tools	NNS	O
in	IN	O
use	NN	O
by	IN	O
Magic	NNP	O
Hound	NNP	O
,	,	O
such	JJ	O
as	IN	O
regular	JJ	O
portable	JJ	O
executable	NN	O
(	(	O
PE	NNP	O
)	)	O
payloads	NNS	O
,	,	O
PE	NNP	O
files	VBZ	O
compiled	VBN	O
in	IN	O
.NET	NNP	O
Framework	NNP	O
,	,	O
various	JJ	O
forms	NNS	O
of	IN	O
IRC	NNP	TOOL
bots	NNS	TOOL
,	,	O
and	CC	O
an	DT	O
open	JJ	O
source	NN	O
file	NN	O
-	:	O
less	CC	O
Python	NNP	O
remote	VBP	TOOL
access	NN	TOOL
tool	NN	TOOL
called	VBN	O
Pupy	NNP	O
.	.	O
The	DT	O
weaponized	JJ	TOOL
Office	NN	TOOL
documents	NNS	TOOL
were	VBD	O
found	VBN	O
to	TO	O
be	VB	O
hosted	VBN	O
either	DT	O
on	IN	O
what	WDT	O
appeared	VBD	O
to	TO	O
be	VB	O
compromised	VBN	O
legitimate	JJ	O
websites	NNS	O
,	,	O
or	CC	O
on	IN	O
websites	NNS	O
using	VBG	O
domain	NN	O
names	NNS	O
similar	JJ	O
to	TO	O
legitimate	VB	O
domain	NN	O
names	NNS	O
in	IN	O
appearance	NN	O
.	.	O
The	DT	O
two	CD	O
legitimate	JJ	O
websites	NNS	O
we	PRP	O
were	VBD	O
able	JJ	O
to	TO	O
identify	VB	O
were	VBD	O
owned	VBN	O
by	IN	O
organizations	NNS	O
in	IN	O
the	DT	O
government	NN	INDUSTRY
and	CC	O
energy	NN	INDUSTRY
sectors	NNS	O
.	.	O
Based	VBN	O
on	IN	O
the	DT	O
existence	NN	O
of	IN	O
these	DT	O
malicious	JJ	O
files	NNS	O
on	IN	O
the	DT	O
legitimate	JJ	O
websites	NNS	O
,	,	O
it	PRP	O
is	VBZ	O
highly	RB	O
probable	JJ	O
that	IN	O
the	DT	O
websites	NNS	O
had	VBD	O
already	RB	O
been	VBN	O
compromised	VBN	O
in	IN	O
some	DT	O
fashion	NN	O
.	.	O
At	IN	O
the	DT	O
time	NN	O
of	IN	O
investigation	NN	O
,	,	O
the	DT	O
files	NNS	O
had	VBD	O
already	RB	O
been	VBN	O
removed	VBN	O
from	IN	O
the	DT	O
websites	NNS	O
.	.	O
The	DT	O
two	CD	O
other	JJ	O
delivery	NN	O
sites	NNS	O
were	VBD	O
ntg	JJ	O
-	:	O
sa[.]com	NN	O
,	,	O
which	WDT	O
may	MD	O
be	VB	O
trying	VBG	O
to	TO	O
spoof	VB	TECHNIQUE
a	DT	O
Saudi	NNP	O
based	VBN	O
information	NN	O
and	CC	O
communication	NN	O
technology	NN	O
conglomerate	NN	O
and	CC	O
mol.com-ho[.]me	NN	O
,	,	O
which	WDT	O
may	MD	O
be	VB	O
trying	VBG	O
to	TO	O
spoof	VB	TECHNIQUE
the	DT	O
Ministry	NNP	O
of	IN	O
Labor	NNP	O
.	.	O
A	DT	O
third	JJ	O
delivery	NN	O
site	NN	O
was	VBD	O
identified	VBN	O
at	IN	O
its.com-ho[.]me	JJ	O
which	WDT	O
may	MD	O
appear	VB	O
to	TO	O
be	VB	O
a	DT	O
benign	JJ	O
domain	NN	O
.	.	O
Several	JJ	O
of	IN	O
these	DT	O
documents	NNS	O
were	VBD	O
also	RB	O
found	VBN	O
on	IN	O
a	DT	O
seemingly	RB	O
unrelated	JJ	O
,	,	O
but	CC	O
benign	SYM	O
-	:	O
looking	VBG	O
domain	NN	O
,	,	O
briefl[.]ink	NN	O
.	.	O
It	PRP	O
is	VBZ	O
highly	RB	O
likely	JJ	O
the	DT	O
adversary	JJ	O
then	RB	O
used	VBD	O
spear	JJ	O
-	:	O
phishing	VBG	O
attacks	NNS	O
containing	VBG	O
links	NNS	O
to	TO	O
these	DT	O
malicious	JJ	O
documents	NNS	O
as	IN	O
a	DT	O
delivery	NN	O
mechanism	NN	O
.	.	O
We	PRP	O
were	VBD	O
ultimately	RB	O
able	JJ	O
to	TO	O
identify	VB	O
multiple	JJ	O
organizations	NNS	O
in	IN	O
the	DT	O
government	NN	INDUSTRY
,	,	O
energy	NN	INDUSTRY
,	,	O
and	CC	O
technology	NN	INDUSTRY
sectors	NNS	INDUSTRY
targeted	VBN	O
by	IN	O
Magic	NNP	O
Hound	NNP	O
.	.	O
The	DT	O
weaponized	JJ	TOOL
documents	NNS	TOOL
themselves	PRP	O
all	DT	O
contained	VBD	O
malicious	JJ	TOOL
macros	NNS	TOOL
which	WDT	O
were	VBD	O
designed	VBN	O
to	TO	O
call	VB	O
Windows	NNP	TOOL
PowerShell	NNP	TOOL
to	TO	O
retrieve	VB	O
additional	JJ	O
tools	NNS	O
.	.	O
A	DT	O
handful	NN	O
of	IN	O
lures	NNS	O
with	IN	O
different	JJ	O
themes	NNS	O
were	VBD	O
used	VBN	O
repeatedly	RB	O
with	IN	O
variations	NNS	O
throughout	IN	O
the	DT	O
eighteen	NN	O
collected	VBN	O
documents	NNS	O
.	.	O
They	PRP	O
ranged	VBD	O
from	IN	O
documents	NNS	O
masquerading	VBG	TECHNIQUE
as	IN	O
official	JJ	O
Saudi	NNP	O
government	NN	INDUSTRY
forms	NNS	O
to	TO	O
a	DT	O
holiday	NN	O
greetings	VBZ	O
card	NN	O
.	.	O
The	DT	O
forms	NNS	O
masquerading	VBG	TECHNIQUE
as	IN	O
official	JJ	O
government	NN	INDUSTRY
documents	NNS	O
specifically	RB	O
used	VBD	O
imagery	NN	O
from	IN	O
the	DT	O
Ministry	NNP	INDUSTRY
of	IN	INDUSTRY
Health	NNP	INDUSTRY
and	CC	O
the	DT	O
Ministry	NNP	INDUSTRY
of	IN	INDUSTRY
Commerce	NNP	INDUSTRY
claiming	VBG	O
to	TO	O
be	VB	O
mandatory	JJ	O
forms	NNS	O
that	WDT	O
required	VBD	O
macros	NNS	O
to	TO	O
be	VB	O
enabled	VBN	O
.	.	O
