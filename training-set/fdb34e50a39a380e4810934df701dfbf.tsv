In	IN	O
the	DT	O
third	JJ	O
week	NN	O
of	IN	O
March	NNP	O
2018	CD	O
,	,	O
through	IN	O
FireEye	NNP	O
's	POS	O
Dynamic	NNP	O
Threat	NNP	O
Intelligence	NNP	O
,	,	O
FireEye	NNP	O
discovered	VBD	O
malicious	JJ	O
macro	SYM	O
-	:	O
based	VBN	O
Microsoft	NNP	O
Word	NNP	O
documents	NNS	O
distributing	VBG	O
SANNY	NNP	MALWARE
malware	NN	O
to	TO	O
multiple	JJ	O
governments	NNS	O
worldwide	VBP	O
.	.	O
Each	DT	O
malicious	JJ	O
document	NN	TECHNIQUE
lure	NN	TECHNIQUE
was	VBD	O
crafted	VBN	O
in	IN	O
regard	NN	O
to	TO	O
relevant	VB	O
regional	JJ	O
geopolitical	JJ	O
issues	NNS	O
.	.	O
FireEye	NNP	O
has	VBZ	O
tracked	VBN	O
the	DT	O
SANNY	NNP	MALWARE
malware	NN	O
family	NN	O
since	IN	O
2012	CD	O
and	CC	O
believes	VBZ	O
that	IN	O
it	PRP	O
is	VBZ	O
unique	JJ	O
to	TO	O
a	DT	O
group	NN	O
focused	VBD	O
on	IN	O
Korean	JJ	LOCATION
Peninsula	NNP	LOCATION
issues	NNS	O
.	.	O
This	DT	O
group	NN	O
has	VBZ	O
consistently	RB	O
targeted	VBN	O
diplomatic	JJ	O
entities	NNS	O
worldwide	VBP	O
,	,	O
primarily	RB	O
using	VBG	O
lure	JJ	TECHNIQUE
documents	NNS	TECHNIQUE
written	VBN	O
in	IN	O
English	NNP	O
and	CC	O
Russian	NNP	O
.	.	O
As	IN	O
part	NN	O
of	IN	O
these	DT	O
recently	RB	O
observed	VBD	O
attacks	NNS	O
,	,	O
the	DT	O
threat	NN	O
actor	NN	O
has	VBZ	O
made	VBN	O
significant	JJ	O
changes	NNS	O
to	TO	O
their	PRP$	O
usual	JJ	O
malware	NN	O
delivery	NN	O
method	NN	O
.	.	O
The	DT	O
attack	NN	O
is	VBZ	O
now	RB	O
carried	VBN	O
out	RP	O
in	IN	O
multiple	JJ	O
stages	NNS	O
,	,	O
with	IN	O
each	DT	O
stage	NN	O
being	VBG	O
downloaded	VBN	O
from	IN	O
the	DT	O
attacker	NN	O
's	POS	O
server	NN	O
.	.	O
Command	NNP	TECHNIQUE
line	NN	TECHNIQUE
evasion	NN	TECHNIQUE
techniques	NNS	TECHNIQUE
,	,	O
the	DT	O
capability	NN	O
to	TO	O
infect	VB	O
systems	NNS	O
running	VBG	O
Windows	NNP	OS
10	CD	OS
,	,	O
and	CC	O
use	NN	O
of	IN	O
recent	JJ	O
User	NNP	O
Account	NNP	O
Control	NNP	O
(	(	O
UAC	NNP	O
)	)	O
bypass	NN	TECHNIQUE
techniques	NNS	TECHNIQUE
have	VBP	O
also	RB	O
been	VBN	O
added	VBN	O
.	.	O
The	DT	O
following	JJ	O
two	CD	O
documents	NNS	O
,	,	O
detailed	VBN	O
below	IN	O
,	,	O
have	VBP	O
been	VBN	O
observed	VBN	O
in	IN	O
the	DT	O
latest	JJS	O
round	NN	O
of	IN	O
attacks	NNS	O
:	:	O
MD5	NNP	O
hash	NN	O
:	:	O
c538b2b2628bba25d68ad601e00ad150	NN	O
SHA256	NNP	O
hash	NN	O
:	:	O
b0f30741a2449f4d8d5ffe4b029a6d3959775818bf2e85bab7fea29bd5acafa4	NN	O
Original	JJ	O
Filename	NN	O
:	:	O
RGNF	NNP	O
2018-2019.doc	JJ	O
MD5	NNP	O
hash	NN	O
:	:	O
7b0f14d8cd370625aeb8a6af66af28ac	CD	O
SHA256	NNP	O
hash	NN	O
:	:	O
e29fad201feba8bd9385893d3c3db42bba094483a51d17e0217ceb7d3a7c08f1	NN	O
Original	JJ	O
Filename	NN	O
:	:	O
Copy	NN	O
of	IN	O
communication	NN	O
from	IN	O
Security	NNP	O
Council	NNP	O
Committee	NNP	O
(	(	O
1718).doc	CD	O
Macro	NNP	O
Analysis	NN	O
In	IN	O
both	DT	O
documents	NNS	O
,	,	O
an	DT	O
embedded	JJ	TECHNIQUE
macro	NN	TECHNIQUE
stores	NNS	O
the	DT	O
malicious	JJ	O
command	NN	O
line	NN	O
to	TO	O
be	VB	O
executed	VBN	O
in	IN	O
the	DT	O
TextBox	NNP	O
property	NN	O
(	(	O
TextBox1.Text	NNP	O
)	)	O
of	IN	O
the	DT	O
document	NN	O
.	.	O
This	DT	O
TextBox	NNP	O
property	NN	O
is	VBZ	O
first	RB	O
accessed	VBN	O
by	IN	O
the	DT	O
macro	NN	O
to	TO	O
execute	VB	O
the	DT	O
command	NN	O
on	IN	O
the	DT	O
system	NN	O
and	CC	O
is	VBZ	O
then	RB	O
overwritten	VBN	O
to	TO	O
delete	VB	O
evidence	NN	O
of	IN	O
the	DT	O
command	NN	O
line	NN	O
.	.	O
In	IN	O
Stage	NNP	O
1	CD	O
,	,	O
the	DT	O
macro	NN	O
leverages	VBZ	O
the	DT	O
legitimate	JJ	O
Microsoft	NNP	O
Windows	NNP	O
certutil.exe	NN	TOOL
utility	NN	TOOL
to	TO	O
download	VB	O
an	DT	O
encoded	JJ	O
Windows	NNP	O
Batch	NNP	O
(	(	O
BAT	NNP	O
)	)	O
file	NN	O
from	IN	O
the	DT	O
following	VBG	O
URL	NN	O
:	:	O
http://more.1apps[.]com/1.txt	NN	O
.	.	O
The	DT	O
macro	NN	O
then	RB	O
decodes	VBZ	O
the	DT	O
encoded	JJ	O
file	NN	O
and	CC	O
drops	VBZ	O
it	PRP	O
in	IN	O
the	DT	O
%	NN	O
temp%	JJ	O
directory	NN	O
with	IN	O
the	DT	O
name	NN	O
:	:	O
1.bat	CD	O
.	.	O
Once	RB	O
decoded	VBN	O
and	CC	O
executed	VBN	O
,	,	O
the	DT	O
BAT	NNP	O
file	NN	O
from	IN	O
Stage	NNP	O
1	CD	O
will	MD	O
download	VB	O
an	DT	O
encoded	JJ	O
CAB	NNP	O
file	NN	O
from	IN	O
the	DT	O
base	NN	O
URL	NNP	O
:	:	O
hxxp://more.1apps[.]com/.	NN	O
The	DT	O
exact	JJ	O
file	NN	O
name	NN	O
downloaded	VBD	O
is	VBZ	O
based	VBN	O
on	IN	O
the	DT	O
architecture	NN	O
of	IN	O
the	DT	O
operating	NN	O
system	NN	O
.	.	O
The	DT	O
BAT	NNP	O
file	NN	O
also	RB	O
checks	VBZ	O
for	IN	O
the	DT	O
presence	NN	O
of	IN	O
Kaspersky	NNP	O
Lab	NNP	O
Antivirus	NNP	O
software	NN	O
on	IN	O
the	DT	O
machine	NN	O
.	.	O
If	IN	O
found	VBN	O
,	,	O
CAB	NNP	O
installation	NN	O
is	VBZ	O
changed	VBN	O
accordingly	RB	O
in	IN	O
an	DT	O
attempt	NN	O
to	TO	O
bypass	VB	TECHNIQUE
detection	NN	TECHNIQUE
.	.	O
SANNY	NNP	MALWARE
malware	NN	O
uses	VBZ	O
the	DT	O
FTP	NNP	O
protocol	NN	O
as	IN	O
the	DT	O
C2	NNP	TECHNIQUE
communication	NN	TECHNIQUE
channel	NN	O
.	.	O
After	IN	O
successful	JJ	O
connection	NN	O
to	TO	O
the	DT	O
FTP	NNP	O
server	NN	O
decoded	VBD	O
from	IN	O
the	DT	O
configuration	NN	O
file	NN	O
,	,	O
the	DT	O
malware	NN	O
searches	VBZ	O
for	IN	O
a	DT	O
file	NN	O
containing	VBG	O
the	DT	O
substring	VBG	O
"	NN	O
to	TO	O
everyone	NN	O
"	NN	O
in	IN	O
the	DT	O
"	NNP	O
htdocs	NN	O
"	NNP	O
directory	NN	O
.	.	O
This	DT	O
file	NN	O
will	MD	O
contain	VB	O
C2	NNP	O
commands	NNS	O
to	TO	O
be	VB	O
executed	VBN	O
by	IN	O
the	DT	O
malware	NN	O
.	.	O
