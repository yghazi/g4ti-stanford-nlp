We	PRP	O
observed	VBD	O
a	DT	O
targeted	JJ	O
attack	NN	O
in	IN	O
November	NNP	O
directed	VBD	O
at	IN	O
an	DT	O
individual	JJ	O
working	NN	O
for	IN	O
the	DT	O
French	JJ	INDUSTRY
Ministry	NNP	INDUSTRY
of	IN	INDUSTRY
Foreign	NNP	INDUSTRY
Affairs	NNP	INDUSTRY
.	.	O
The	DT	O
attack	NN	O
involved	VBD	O
a	DT	O
spear	JJ	O
-	:	O
phishing	VBG	O
email	JJ	O
sent	NN	O
to	TO	O
a	DT	O
single	JJ	O
French	JJ	O
diplomat	NN	O
based	VBN	O
in	IN	O
Taipei	NNP	LOCATION
,	,	O
Taiwan	NNP	LOCATION
and	CC	O
contained	VBD	O
an	DT	O
invitation	NN	O
to	TO	O
a	DT	O
Science	NNP	O
and	CC	O
Technology	NNP	O
support	NN	O
group	NN	O
event	NN	O
.	.	O
The	DT	O
actors	NNS	O
attempted	VBD	O
to	TO	O
exploit	VB	O
CVE-2014	NNP	O
-	:	O
6332	CD	O
using	VBG	O
a	DT	O
slightly	RB	O
modified	VBN	O
version	NN	O
of	IN	O
the	DT	O
proof	NN	O
of	IN	O
concept	NN	O
(	(	O
POC	NNP	O
)	)	O
code	NN	O
to	TO	O
install	VB	O
a	DT	O
Trojan	NNP	TOOL
called	VBN	O
Emissary	NNP	MALWARE
,	,	O
which	WDT	O
is	VBZ	O
related	VBN	O
to	TO	O
the	DT	O
Operation	NNP	O
Lotus	NNP	O
Blossom	NNP	O
campaign	NN	O
.	.	O
The	DT	O
TTPs	NNP	O
used	VBN	O
in	IN	O
this	DT	O
attack	NN	O
also	RB	O
match	VBP	O
those	DT	O
detailed	VBN	O
in	IN	O
the	DT	O
paper	NN	O
.	.	O
The	DT	O
targeting	NN	O
of	IN	O
this	DT	O
individual	JJ	O
suggests	VBZ	O
the	DT	O
actors	NNS	O
are	VBP	O
interested	JJ	O
in	IN	O
breaching	VBG	O
the	DT	O
French	JJ	INDUSTRY
Ministry	NNP	INDUSTRY
of	IN	INDUSTRY
Foreign	NNP	INDUSTRY
Affairs	NNPS	INDUSTRY
itself	PRP	O
or	CC	O
gaining	VBG	O
insights	NNS	O
into	IN	O
relations	NNS	O
between	IN	O
France	NNP	LOCATION
and	CC	O
Taiwan	NNP	LOCATION
.	.	O
On	IN	O
November	NNP	O
10	CD	O
,	,	O
2015	CD	O
,	,	O
threat	NN	O
actors	NNS	O
sent	VBD	O
a	DT	O
spear	JJ	O
-	:	O
phishing	VBG	O
email	NN	O
to	TO	O
an	DT	O
individual	NN	O
at	IN	O
the	DT	O
French	JJ	INDUSTRY
Ministry	NNP	INDUSTRY
of	IN	INDUSTRY
Foreign	NNP	INDUSTRY
Affairs	NNP	INDUSTRY
.	.	O
The	DT	O
subject	NN	O
and	CC	O
the	DT	O
body	NN	O
of	IN	O
the	DT	O
email	NN	O
suggest	VBP	O
the	DT	O
targeted	JJ	O
individual	NN	O
had	VBD	O
been	VBN	O
invited	VBN	O
to	TO	O
a	DT	O
Science	NNP	O
and	CC	O
Technology	NNP	O
conference	NN	O
in	IN	O
Hsinchu	NNP	LOCATION
,	,	O
Taiwan	NNP	LOCATION
.	.	O
The	DT	O
email	NN	O
appears	VBZ	O
quite	RB	O
timely	RB	O
,	,	O
as	IN	O
the	DT	O
conference	NN	O
was	VBD	O
held	VBN	O
on	IN	O
November	NNP	O
13	CD	O
,	,	O
2015	CD	O
,	,	O
which	WDT	O
is	VBZ	O
three	CD	O
days	NNS	O
after	IN	O
the	DT	O
attack	NN	O
took	VBD	O
place	NN	O
.	.	O
The	DT	O
email	NN	O
body	NN	O
contained	VBD	O
a	DT	O
link	NN	O
to	TO	O
the	DT	O
legitimate	JJ	O
registration	NN	O
page	NN	O
for	IN	O
the	DT	O
conference	NN	O
,	,	O
but	CC	O
the	DT	O
email	NN	O
also	RB	O
had	VBD	O
two	CD	O
attachments	NNS	O
.	.	O
Both	DT	O
attachments	NNS	O
are	VBP	O
malicious	JJ	TECHNIQUE
Word	NNP	TECHNIQUE
documents	NNS	TECHNIQUE
that	WDT	O
attempt	VBP	O
to	TO	O
exploit	VB	O
the	DT	O
Windows	NNP	APP
OLE	NNP	APP
Automation	NNP	O
Array	NNP	O
Remote	NNP	O
Code	NNP	O
Execution	NNP	O
Vulnerability	NNP	O
tracked	VBN	O
by	IN	O
CVE-2014	NNP	O
-	:	O
6332	CD	O
.	.	O
Upon	IN	O
successful	JJ	O
exploitation	NN	O
,	,	O
the	DT	O
attachments	NNS	O
will	MD	O
install	VB	O
a	DT	O
Trojan	NNP	TOOL
named	VBN	O
Emissary	NNP	MALWARE
and	CC	O
open	VB	O
a	DT	O
Word	NNP	O
document	NN	O
as	IN	O
a	DT	O
decoy	NN	O
.	.	O
The	DT	O
threat	NN	O
actors	NNS	O
attempted	VBD	O
to	TO	O
exploit	VB	O
CVE-2014	NNP	O
-	:	O
6332	CD	O
using	VBG	O
the	DT	O
POC	NNP	O
code	NN	O
available	JJ	O
in	IN	O
the	DT	O
wild	NN	O
.	.	O
The	DT	O
POC	NNP	O
code	NN	O
contains	VBZ	O
inline	JJ	O
comments	NNS	O
that	WDT	O
explain	VBP	O
how	WRB	O
the	DT	O
malicious	JJ	O
VBScript	NNP	TOOL
exploits	VBZ	O
this	DT	O
vulnerability	NN	O
,	,	O
so	IN	O
instead	RB	O
of	IN	O
discussing	VBG	O
the	DT	O
malicious	JJ	O
script	NN	O
or	CC	O
exploit	VB	O
itself	PRP	O
,	,	O
we	PRP	O
will	MD	O
focus	VB	O
on	IN	O
the	DT	O
portions	NNS	O
of	IN	O
the	DT	O
script	NN	O
that	IN	O
the	DT	O
threat	NN	O
actors	NNS	O
modified	VBD	O
.	.	O
The	DT	O
actors	NNS	O
removed	VBD	O
the	DT	O
explanatory	JJ	O
comments	NNS	O
from	IN	O
the	DT	O
VBScript	NNP	TOOL
and	CC	O
made	VBD	O
slight	JJ	O
modifications	NNS	O
to	TO	O
the	DT	O
POC	NNP	O
code	NN	O
.	.	O
The	DT	O
only	JJ	O
major	JJ	O
functional	JJ	O
difference	NN	O
between	IN	O
the	DT	O
POC	NNP	O
and	CC	O
the	DT	O
VBScript	NNP	TOOL
involved	VBD	O
adding	VBG	O
the	DT	O
ability	NN	O
to	TO	O
extract	VB	O
and	CC	O
run	VB	O
both	DT	O
a	DT	O
decoy	NN	O
document	NN	O
and	CC	O
payload	NN	O
.	.	O
Figure	NN	O
3	CD	O
and	CC	O
4	CD	O
compare	VBP	O
the	DT	O
differing	VBG	O
"	NN	O
runshell	NN	O
"	NNP	O
command	NN	O
within	IN	O
the	DT	O
POC	NNP	O
and	CC	O
the	DT	O
malicious	JJ	O
documents	NNS	O
used	VBN	O
in	IN	O
this	DT	O
attack	NN	O
.	.	O
The	DT	O
code	NN	O
in	IN	O
Figure	NNP	O
3	CD	O
shows	VBZ	O
that	IN	O
the	DT	O
POC	NNP	O
does	VBZ	O
nothing	NN	O
more	JJR	O
than	IN	O
launch	NN	O
the	DT	O
notepad.exe	JJ	O
application	NN	O
upon	IN	O
successful	JJ	O
exploitation	NN	O
.	.	O
Figure	NN	O
4	CD	O
shows	VBZ	O
the	DT	O
malicious	JJ	O
document	NN	O
creating	VBG	O
a	DT	O
file	NN	O
named	VBN	O
"	NNP	O
ss.vbs	NN	O
"	NN	O
that	IN	O
it	PRP	O
writes	VBZ	O
a	DT	O
VBScript	NNP	TOOL
to	TO	O
using	VBG	O
a	DT	O
series	NN	O
of	IN	O
"	NNP	O
echo	VBP	O
"	JJ	O
statements	NNS	O
.	.	O
After	IN	O
writing	VBG	O
the	DT	O
VBScript	NNP	TOOL
,	,	O
the	DT	O
malicious	JJ	O
document	NN	O
executes	VBZ	O
the	DT	O
"	NNP	O
ss.vbs	NN	O
"	NNP	O
file	NN	O
.	.	O
The	DT	O
loader	NN	O
Trojan	NNP	TOOL
named	VBD	O
"	NNP	O
ishelp.dll	NN	O
"	NNP	O
had	VBD	O
an	DT	O
original	JJ	O
name	NN	O
of	IN	O
"	NNP	O
Loader.dll	NNP	O
"	NNP	O
,	,	O
which	WDT	O
will	MD	O
extract	VB	O
the	DT	O
Emissary	NNP	MALWARE
payload	NN	O
from	IN	O
a	DT	O
resource	NN	O
named	VBN	O
"	NNP	O
asdasdasdasdsad	JJ	O
"	NN	O
and	CC	O
write	VB	O
it	PRP	O
to	TO	O
a	DT	O
file	NN	O
named	VBN	O
"	NNP	O
A08E81B411.DAT	NNP	O
"	NNP	O
.	.	O
The	DT	O
loader	NN	O
will	MD	O
then	RB	O
write	VB	O
an	DT	O
embedded	JJ	O
configuration	NN	O
to	TO	O
a	DT	O
file	NN	O
named	VBN	O
"	$	O
75BD50EC.DAT	CD	O
"	NN	O
.	.	O
The	DT	O
loader	NN	O
Trojan	NNP	TOOL
creates	VBZ	O
a	DT	O
mutex	NN	O
named	VBN	O
"	NNP	O
_	NNP	O
MICROSOFT_LOADER_MUTEX	NNP	O
_	NNP	O
"	NNP	O
and	CC	O
finishes	NNS	O
by	IN	O
injecting	VBG	O
the	DT	O
Emissary	NNP	MALWARE
DLL	NNP	O
in	IN	O
"	NNP	O
A08E81B411.DAT	NNP	O
"	NNP	O
into	IN	O
a	DT	O
newly	RB	O
spawned	VBN	O
Internet	NNP	APP
Explorer	NNP	APP
process	NN	O
.	.	O
After	IN	O
decrypting	VBG	O
the	DT	O
configuration	NN	O
file	NN	O
,	,	O
Emissary	NNP	MALWARE
interacts	VBZ	O
with	IN	O
its	PRP$	O
command	NN	TECHNIQUE
and	CC	TECHNIQUE
control	NN	TECHNIQUE
(	(	O
C2	NNP	O
)	)	O
servers	NNS	O
using	VBG	O
HTTP	NNP	O
or	CC	O
HTTPS	NNP	O
,	,	O
depending	VBG	O
on	IN	O
the	DT	O
protocol	NN	O
specified	VBN	O
in	IN	O
the	DT	O
configuration	NN	O
file	NN	O
.	.	O
The	DT	O
initial	JJ	O
network	NN	O
beacon	NN	O
sent	NN	O
from	IN	O
Emissary	NNP	MALWARE
to	TO	O
its	PRP$	O
C2	NNP	O
server	NN	O
,	,	O
seen	VBN	O
in	IN	O
Figure	NNP	O
7	CD	O
,	,	O
includes	VBZ	O
a	DT	O
Cookie	NNP	O
field	NN	O
that	WDT	O
contains	VBZ	O
a	DT	O
"	JJ	O
GUID	NNP	O
"	NNP	O
,	,	O
"	NNP	O
op	MD	O
"	VB	O
and	CC	O
"	VB	O
SHO	NNP	O
"	NNP	O
field	NN	O
.	.	O
