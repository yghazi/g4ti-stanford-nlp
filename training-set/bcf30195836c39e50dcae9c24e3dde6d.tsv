We	PRP	O
observed	VBD	O
a	DT	O
DropIt	NNP	MALWARE
sample	NN	O
installing	VBG	O
another	DT	O
Trojan	NNP	TOOL
we	PRP	O
call	VBP	O
MagicHound	NNP	O
.	.	O
Retriever	NNP	MALWARE
.	.	O
At	IN	O
a	DT	O
high	JJ	O
level	NN	O
,	,	O
Retriever	NNP	MALWARE
is	VBZ	O
a	DT	O
.NET	JJ	O
downloader	NN	TOOL
that	WDT	O
downloads	VBZ	O
secondary	JJ	O
payloads	NNS	O
from	IN	O
servers	NNS	O
associated	VBN	O
with	IN	O
Magic	NNP	O
Hound	NNP	O
.	.	O
While	IN	O
the	DT	O
Trojan	NNP	TOOL
itself	PRP	O
does	VBZ	O
not	RB	O
resemble	VB	O
the	DT	O
other	JJ	O
Magic	NNP	TOOL
Hound	NNP	TOOL
tools	VBZ	TOOL
,	,	O
it	PRP	O
does	VBZ	O
create	VB	O
a	DT	O
folder	NN	O
named	VBN	O
"	NNP	O
c:\temp	NN	O
"	NN	O
that	IN	O
the	DT	O
Magic	NNP	TOOL
Hound	NNP	TOOL
loader	NN	TOOL
creates	VBZ	O
to	TO	O
store	VB	O
its	PRP$	O
persistence	NN	O
executable	JJ	O
,	,	O
as	IN	O
previously	RB	O
discussed	VBN	O
.	.	O
The	DT	O
folder	NN	O
name	NN	O
is	VBZ	O
quite	RB	O
generic	JJ	O
and	CC	O
by	IN	O
itself	PRP	O
is	VBZ	O
not	RB	O
a	DT	O
great	JJ	O
correlation	NN	O
point	NN	O
,	,	O
however	RB	O
,	,	O
this	DT	O
coupled	VBN	O
with	IN	O
the	DT	O
shared	JJ	O
infrastructure	NN	O
makes	VBZ	O
a	DT	O
higher	JJR	O
fidelity	NN	O
connection	NN	O
between	IN	O
the	DT	O
two	CD	O
.	.	O
The	DT	O
Retriever	NNP	MALWARE
Trojan	NNP	TOOL
uses	VBZ	O
the	DT	O
following	JJ	O
namespace	NN	O
:	:	O
using	VBG	O
pcchekapp.grp.ammar.samaneh	NN	O
;	:	O
The	DT	O
malware	NN	O
begins	VBZ	O
by	IN	O
creating	VBG	O
a	DT	O
web	NN	O
service	NN	O
object	NN	O
and	CC	O
uses	VBZ	O
the	DT	O
following	JJ	O
URL	NNP	O
within	IN	O
its	PRP$	O
configuration	NN	O
:	:	O
http://	NN	O
service.chrome-up[.]date:8080	NN	O
/WebService.asmx	NN	O
It	PRP	O
then	RB	O
calls	VBZ	O
a	DT	O
function	NN	O
called	VBN	O
"	NNP	O
SetLog2	NNP	O
"	NNP	O
,	,	O
which	WDT	O
sets	VBZ	O
variables	NNS	O
for	IN	O
the	DT	O
system	NN	O
's	POS	O
IP	NNP	O
address	NN	O
,	,	O
MAC	NNP	O
address	NN	O
and	CC	O
hostname	NN	O
.	.	O
A	DT	O
password	NN	O
variable	NN	O
is	VBZ	O
available	JJ	O
but	CC	O
unused	JJ	O
in	IN	O
this	DT	O
sample	NN	O
.	.	O
The	DT	O
code	NN	O
will	MD	O
gather	VB	EFFECT
some	DT	EFFECT
information	NN	EFFECT
about	IN	O
the	DT	O
system	NN	O
,	,	O
specifically	RB	O
the	DT	O
local	JJ	O
IP	NNP	O
address	NN	O
,	,	O
MAC	NNP	O
address	NN	O
,	,	O
and	CC	O
the	DT	O
external	JJ	O
IP	NNP	O
address	NN	O
of	IN	O
the	DT	O
system	NN	O
.	.	O
The	DT	O
code	NN	O
obtains	VBZ	O
the	DT	O
external	JJ	O
IP	NNP	O
address	NN	O
via	IN	O
an	DT	O
HTTP	NNP	O
request	NN	O
using	VBG	O
to	TO	O
"	VB	O
http://checkip.dyndns.org/	JJ	O
"	NN	O
and	CC	O
uses	VBZ	O
a	DT	O
regular	JJ	O
expression	NN	O
to	TO	O
locate	VB	O
an	DT	O
IP	NNP	O
address	NN	O
from	IN	O
the	DT	O
HTTP	NNP	O
response	NN	O
.	.	O
Once	RB	O
these	DT	O
variables	NNS	O
are	VBP	O
set	VBN	O
,	,	O
the	DT	O
malware	NN	O
uses	VBZ	O
the	DT	O
SoapHttpClientProtocol	NNP	O
class	NN	O
to	TO	O
communicate	VB	O
with	IN	O
its	PRP$	O
C2	NNP	TECHNIQUE
server	NN	O
,	,	O
which	WDT	O
issues	NNS	O
an	DT	O
HTTP	NNP	O
POST	NNP	O
request	NN	O
.	.	O
As	IN	O
you	PRP	O
can	MD	O
see	VB	O
from	IN	O
the	DT	O
above	JJ	O
request	NN	O
,	,	O
the	DT	O
SoapHttpClientProtocol	NNP	O
class	NN	O
neatly	RB	O
structures	VBZ	O
data	NNS	O
into	IN	O
an	DT	O
HTTP	NNP	O
POST	NNP	O
request	NN	O
.	.	O
All	DT	O
subsequent	JJ	O
interaction	NN	O
with	IN	O
the	DT	O
C2	NNP	TECHNIQUE
server	NN	O
uses	VBZ	O
the	DT	O
same	JJ	O
SOAP	NNP	O
web	NN	O
service	NN	O
,	,	O
so	IN	O
we	PRP	O
will	MD	O
not	RB	O
show	VB	O
all	DT	O
of	IN	O
the	DT	O
generated	JJ	O
HTTP	NNP	O
requests	NNS	O
.	.	O
Instead	RB	O
,	,	O
we	PRP	O
will	MD	O
refer	VB	O
to	TO	O
the	DT	O
specific	JJ	O
SOAP	NNP	O
action	NN	O
(	(	O
see	VB	O
"	JJ	O
SOAPAction	NNP	O
"	NNP	O
field	NN	O
in	IN	O
previous	JJ	O
example	NN	O
,	,	O
specifically	RB	O
"	JJ	O
SetLog2	NNP	O
"	NNP	O
)	)	O
that	IN	O
the	DT	O
Trojan	NNP	TOOL
requests	NNS	O
from	IN	O
the	DT	O
C2	NNP	TECHNIQUE
server	NN	O
and	CC	O
the	DT	O
response	NN	O
from	IN	O
the	DT	O
C2	NNP	TECHNIQUE
server	NN	O
.	.	O
After	IN	O
sending	VBG	O
the	DT	O
C2	NNP	TECHNIQUE
the	DT	O
system	NN	O
information	NN	O
,	,	O
the	DT	O
malware	NN	O
then	RB	O
issues	NNS	O
a	DT	O
second	JJ	O
request	NN	O
for	IN	O
"	NN	O
GetHasAnything	NNP	O
"	NNP	O
,	,	O
which	WDT	O
will	MD	O
communicate	VB	O
with	IN	O
the	DT	O
C2	NNP	TECHNIQUE
server	NN	O
and	CC	O
ask	VB	O
the	DT	O
server	NN	O
if	IN	O
it	PRP	O
has	VBZ	O
a	DT	O
secondary	JJ	O
binary	NN	O
for	IN	O
the	DT	O
Trojan	NNP	TOOL
to	TO	O
install	VB	O
.	.	O
With	IN	O
the	DT	O
file	NN	O
written	VBN	O
to	TO	O
the	DT	O
system	NN	O
,	,	O
the	DT	O
Trojan	NNP	TOOL
calls	VBZ	O
the	DT	O
"	NNP	O
GetishideAbById	NNP	O
"	NNP	O
SOAP	NNP	O
action	NN	O
to	TO	O
determine	VB	O
whether	IN	O
or	CC	O
not	RB	O
the	DT	O
C2	NNP	TECHNIQUE
server	NN	O
wishes	NNS	O
to	TO	O
execute	VB	O
the	DT	O
newly	RB	O
dropped	VBN	O
file	NN	O
in	IN	O
a	DT	O
hidden	JJ	O
window	NN	O
.	.	O
This	DT	O
request	NN	O
is	VBZ	O
followed	VBN	O
by	IN	O
a	DT	O
call	NN	O
to	TO	O
"	VB	O
GetisrunasAbById	NNP	O
"	NNP	O
to	TO	O
determine	VB	O
if	IN	O
the	DT	O
Trojan	NNP	TOOL
should	MD	O
use	VB	O
"	NNP	O
runas	NNS	O
"	VBP	O
to	TO	O
execute	VB	O
the	DT	O
downloaded	JJ	O
executable	JJ	O
with	IN	O
elevated	JJ	O
privileges	NNS	O
,	,	O
which	WDT	O
would	MD	O
display	VB	O
the	DT	O
UAC	NNP	O
dialog	NN	O
for	IN	O
the	DT	O
user	NN	O
to	TO	O
click	VB	O
.	.	O
Unfortunately	RB	O
,	,	O
we	PRP	O
were	VBD	O
unable	JJ	O
to	TO	O
obtain	VB	O
a	DT	O
secondary	JJ	O
payload	NN	O
from	IN	O
an	DT	O
active	JJ	O
C2	NNP	TECHNIQUE
server	NN	O
.	.	O
