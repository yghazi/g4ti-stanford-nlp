This	DT	O
MPK	NNP	TOOL
IRC	NNP	TOOL
bot	NN	TOOL
is	VBZ	O
very	RB	O
similar	JJ	O
to	TO	O
the	DT	O
MPK	NNP	TOOL
Trojan	NNP	TOOL
that	WDT	O
used	VBD	O
a	DT	O
custom	NN	O
C2	NNP	TECHNIQUE
communications	NNS	O
protocol	NN	O
,	,	O
as	IN	O
discussed	VBN	O
in	IN	O
the	DT	O
whitepaper	NN	O
by	IN	O
CheckPoint	NNP	O
discussing	VBG	O
a	DT	O
threat	NN	O
group	NN	O
called	VBD	O
Rocket	NNP	ACTOR
Kitten	NNP	ACTOR
.	.	O
We	PRP	O
believe	VBP	O
this	DT	O
version	NN	O
of	IN	O
the	DT	O
MPK	NNP	TOOL
Trojan	NNP	TOOL
is	VBZ	O
based	VBN	O
on	IN	O
the	DT	O
same	JJ	O
code	NN	O
base	NN	O
,	,	O
as	IN	O
both	DT	O
the	DT	O
IRC	NNP	O
version	NN	O
and	CC	O
the	DT	O
one	CD	O
discussed	VBN	O
in	IN	O
the	DT	O
above	JJ	O
white	JJ	O
paper	NN	O
have	VBP	O
considerable	JJ	O
similarities	NNS	O
from	IN	O
a	DT	O
behavior	JJ	O
standpoint	NN	O
and	CC	O
both	DT	O
Trojan	NNP	TOOL
have	VBP	O
direct	JJ	O
code	NN	O
sharing	VBG	O
between	IN	O
them	PRP	O
.	.	O
From	IN	O
a	DT	O
behaviorial	JJ	O
standpoint	NN	O
,	,	O
both	CC	O
the	DT	O
IRC	NNP	O
and	CC	O
custom	NN	O
protocol	JJ	O
version	NN	O
of	IN	O
MPK	NNP	O
save	VBP	O
"	NNP	O
tmp.vbs	NN	O
"	NN	O
and	CC	O
"	NNP	O
tmp1.vbs	VBP	O
"	NN	O
to	TO	O
the	DT	O
%	NN	O
TEMP%	NNP	O
folder	NN	O
(	(	O
both	DT	O
differed	VBN	O
slightly	RB	O
but	CC	O
used	VBD	O
the	DT	O
same	JJ	O
variable	JJ	O
names	NNS	O
within	IN	O
the	DT	O
script	NN	O
)	)	O
in	IN	O
order	NN	O
to	TO	O
copy	VB	O
the	DT	O
Trojan	NNP	TOOL
to	TO	O
its	PRP$	O
final	JJ	O
location	NN	O
and	CC	O
to	TO	O
execute	VB	O
it	PRP	O
.	.	O
Both	DT	O
variants	NNS	O
need	VBP	O
to	TO	O
be	VB	O
executed	VBN	O
with	IN	O
the	DT	O
command	NN	O
line	NN	O
argument	NN	O
"	NNP	O
[	VBZ	O
2	CD	O
]	NN	O
"	NN	O
to	TO	O
avoid	VB	O
continually	RB	O
attempting	VBG	O
to	TO	O
copy	VB	O
and	CC	O
execute	VB	O
the	DT	O
Trojan	NNP	TOOL
using	VBG	O
the	DT	O
"	NNP	O
tmp.vbs	NN	O
"	NN	O
and	CC	O
"	NNP	O
tmp1.vbs	VBP	O
"	JJ	O
files	NNS	O
.	.	O
The	DT	O
two	CD	O
variants	NNS	O
of	IN	O
MPK	NNP	O
share	NN	O
the	DT	O
same	JJ	O
registry	NN	O
key	NN	O
that	IN	O
the	DT	O
Trojan	NNP	TOOL
uses	VBZ	O
to	TO	O
automatically	RB	O
run	VB	O
each	DT	O
time	NN	O
the	DT	O
system	NN	O
starts	VBZ	O
,	,	O
specifically	RB	O
:	:	O
[	NN	O
HKLM	NNP	O
and	CC	O
HKCU]\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\explorer	NNP	O
Both	NNP	O
MPK	NNP	O
variants	NNS	O
include	VBP	O
key	JJ	TOOL
loggers	NNS	TOOL
that	WDT	O
are	VBP	O
extremely	RB	O
similar	JJ	O
in	IN	O
functionality	NN	O
in	IN	O
addition	NN	O
to	TO	O
having	VBG	O
the	DT	O
same	JJ	O
strings	NNS	O
used	VBN	O
for	IN	O
headers	NNS	O
within	IN	O
the	DT	O
key	JJ	O
log	NN	O
file	NN	O
.	.	O
The	DT	O
MPK	NNP	TOOL
IRC	NNP	TOOL
Bot	NNP	TOOL
monitors	NNS	O
active	JJ	O
application	NN	O
windows	NNS	O
and	CC	O
writes	VBZ	O
the	DT	O
title	NN	O
of	IN	O
the	DT	O
open	JJ	O
window	NN	O
along	IN	O
with	IN	O
the	DT	O
logged	JJ	O
keystrokes	NNS	O
to	TO	O
a	DT	O
file	NN	O
at	IN	O
"	NNP	O
%	NN	O
temp%\Save.tmp	NN	O
"	NN	O
.	.	O
The	DT	O
MPK	NNP	TOOL
Trojan	NNP	TOOL
also	RB	O
monitors	VBZ	O
specifically	RB	O
for	IN	O
windows	NNS	O
that	WDT	O
are	VBP	O
likely	JJ	O
to	TO	O
contain	VB	O
login	JJ	O
forms	NNS	O
for	IN	O
popular	JJ	O
web	NN	O
-	:	O
based	VBN	O
email	JJ	O
clients	NNS	O
.	.	O
The	DT	O
major	JJ	O
difference	NN	O
between	IN	O
the	DT	O
IRC	NNP	O
variant	NN	O
and	CC	O
non	JJ	O
-	:	O
IRC	NNP	O
variant	NN	O
of	IN	O
MPK	NNP	O
is	VBZ	O
the	DT	O
C2	NNP	TECHNIQUE
protocol	NN	O
used	VBN	O
.	.	O
The	DT	O
IRC	NNP	O
variant	NN	O
creates	VBZ	O
a	DT	O
mutex	NN	O
named	VBN	O
"	NNP	O
mpk1	NN	O
"	NN	O
and	CC	O
attempts	NNS	O
to	TO	O
connect	VB	O
to	TO	O
an	DT	O
IRC	NNP	O
server	NN	O
at	IN	O
45.58.37[.]142:6667	CD	O
.	.	O
The	DT	O
MPK	NNP	TOOL
bot	NN	TOOL
generates	VBZ	O
a	DT	O
random	JJ	O
lowercase	NN	O
name	NN	O
and	CC	O
uses	VBZ	O
it	PRP	O
to	TO	O
log	VB	O
into	IN	O
the	DT	O
IRC	NNP	O
server	NN	O
.	.	O
The	DT	O
commands	NNS	O
available	JJ	O
within	IN	O
the	DT	O
MPK	NNP	TOOL
IRC	NNP	TOOL
bot	NN	TOOL
are	VBP	O
called	VBN	O
via	IN	O
a	DT	O
jump	NN	O
table	NN	O
,	,	O
rather	RB	O
than	IN	O
a	DT	O
switch	NN	O
statement	NN	O
used	VBN	O
in	IN	O
the	DT	O
custom	NN	O
protocol	NN	O
variant	NN	O
of	IN	O
MPK	NNP	O
.	.	O
The	DT	O
IRC	NNP	O
variant	NN	O
of	IN	O
MPK	NNP	O
has	VBZ	O
a	DT	O
command	NN	O
set	VBN	O
(	(	O
Table	JJ	O
2	CD	O
)	)	O
that	WDT	O
makes	VBZ	O
this	DT	O
an	DT	O
effective	JJ	O
backdoor	NN	TOOL
Trojan	NNP	TOOL
,	,	O
specifically	RB	O
allowing	VBG	O
the	DT	O
actors	NNS	O
to	TO	O
steal	VB	EFFECT
credentials	NNS	EFFECT
from	IN	O
the	DT	O
targeted	JJ	O
system	NN	O
via	IN	O
keylogging	NN	TECHNIQUE
,	,	O
to	TO	O
navigate	VB	O
and	CC	O
interact	VB	O
with	IN	O
the	DT	O
file	NN	O
system	NN	O
,	,	O
to	TO	O
run	VB	O
arbitrary	JJ	O
commands	NNS	O
,	,	O
and	CC	O
to	TO	O
download	VB	O
and	CC	O
execute	VB	O
additional	JJ	O
tools	NNS	O
on	IN	O
the	DT	O
system	NN	O
.	.	O
